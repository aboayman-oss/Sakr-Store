<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Product Details - Sakr Store</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css">
    <link rel="stylesheet" href="css/style.css">
  </head>
  <body>
    <header>
      <button id="menu-toggle" class="hamburger-menu" aria-label="Toggle menu" aria-controls="category-sidebar" aria-expanded="false">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <h1>Sakr Store</h1>
      <nav>
        <button id="theme-toggle-btn" aria-label="Toggle dark mode">
          <i class="ri-sun-line" id="light-icon"></i>
          <i class="ri-moon-line" id="dark-icon"></i>
        </button>
        <a href="cart.html" class="cart-link" aria-label="View shopping cart">
          <i class="ri-shopping-cart-2-line"></i>
          <span class="cart-count" aria-label="Items in cart">0</span>
        </a>
      </nav>
    </header>
    <div id="menu-overlay" class="menu-overlay"></div>
    
    <main class="product-detail-page">
      <div class="product-container">
        <div class="product-image">
          <img src="" alt="" id="product-image">
        </div>
        <div class="product-info">
          <h1 id="product-title"></h1>
          <p class="product-price" id="product-price"></p>
          <p class="product-description" id="product-description"></p>
          <div class="product-actions">
            <div class="quantity-selector">
              <button class="quantity-btn" id="decrease-quantity" aria-label="Decrease quantity">-</button>
              <input type="number" id="quantity" value="1" min="1" aria-label="Product quantity">
              <button class="quantity-btn" id="increase-quantity" aria-label="Increase quantity">+</button>
            </div>
            <button class="add-to-cart-btn" id="add-to-cart">
              <i class="ri-shopping-cart-2-line"></i>
              Add to Cart
            </button>
          </div>
        </div>
      </div>
    </main>

    <!-- Toast notification container -->
    <div id="toast-container" class="toast-container" aria-live="polite"></div>
    
    <script src="js/app.js"></script>
    <script>
      // Product page specific JavaScript
      document.addEventListener('DOMContentLoaded', () => {
        const urlParams = new URLSearchParams(window.location.search);
        const productId = parseInt(urlParams.get('id'));
        
        // Quantity controls
        const quantityInput = document.getElementById('quantity');
        const decreaseBtn = document.getElementById('decrease-quantity');
        const increaseBtn = document.getElementById('increase-quantity');
        
        decreaseBtn.addEventListener('click', () => {
          const currentValue = parseInt(quantityInput.value);
          if (currentValue > 1) {
            quantityInput.value = currentValue - 1;
          }
        });
        
        increaseBtn.addEventListener('click', () => {
          const currentValue = parseInt(quantityInput.value);
          quantityInput.value = currentValue + 1;
        });

        // Load and display product details
        fetch('products.json')
          .then(response => response.json())
          .then(products => {
            const product = products.find(p => p.id === productId);
            if (product) {
              document.getElementById('product-image').src = product.image;
              document.getElementById('product-image').alt = product.name;
              document.getElementById('product-title').textContent = product.name;
              document.getElementById('product-price').textContent = `$${product.price.toFixed(2)}`;
              document.getElementById('product-description').textContent = product.description || '';
            } else {
              window.location.href = 'index.html'; // Redirect if product not found
            }
          })
          .catch(error => {
            console.error('Error loading product:', error);
            window.location.href = 'index.html';
          });

        // Add to cart functionality
        const addToCartBtn = document.getElementById('add-to-cart');
        addToCartBtn.addEventListener('click', () => {
          const quantity = parseInt(quantityInput.value);
          for (let i = 0; i < quantity; i++) {
            addToCart(productId); // Use the app.js addToCart function
          }
          
          // Visual feedback
          addToCartBtn.classList.add('added');
          setTimeout(() => addToCartBtn.classList.remove('added'), 1000);
        });
      });
    </script>
  </body>
</html>